function AdfUserInactivityTimeoutHelper(a){this.Init(a)}AdfObject.createSubclass(AdfUserInactivityTimeoutHelper);AdfUserInactivityTimeoutHelper.prototype.registerPollComponent=function(a){AdfAssert.assertObject(a);var b=a.getClientId();this._componentIDsArray.push(b);a=a.getTimeout();if(null==this._maxComponentTimeoutInterval)this._maxComponentTimeoutInterval=a;else if(-1==a||-1!=this._maxComponentTimeoutInterval&&a>this._maxComponentTimeoutInterval)this._maxComponentTimeoutInterval=a};
AdfUserInactivityTimeoutHelper.prototype.unregisterPollComponent=function(a){AdfAssert.assertObject(a);a=a.getClientId();AdfCollections.removeArrayValue(this._componentIDsArray,a);this._globalTimeoutInterval=this._calculatePollingTimeoutInterval(this._defaultTimeoutInterval)};AdfUserInactivityTimeoutHelper.prototype.hasTimedOut=function(){return this._hasTimedOut};AdfUserInactivityTimeoutHelper.prototype.isTimeoutEnabled=function(){return-1!=this._globalTimeoutInterval};
AdfUserInactivityTimeoutHelper.prototype.initializeTimeout=function(a){AdfAssert.assertNumberOrNull(a);this._defaultTimeoutInterval=a;var b=this._globalTimeoutInterval;this._globalTimeoutInterval=this._maxComponentTimeoutInterval?this._maxComponentTimeoutInterval:a;this._globalTimeoutInterval!=b&&this._rescheduleOrScheduleTimerIfNeeded()};AdfUserInactivityTimeoutHelper.InitClass=function(){};
AdfUserInactivityTimeoutHelper.prototype.Init=function(){AdfUserInactivityTimeoutHelper.superclass.Init.call(this);this._componentIDsArray=[];this._defaultTimeoutInterval=null;this._globalTimeoutInterval=-1;this._maxComponentTimeoutInterval=null;this._hasTimedOut=!1};
AdfUserInactivityTimeoutHelper.prototype._calculatePollingTimeoutInterval=function(a){var b=this._componentIDsArray,d=AdfPage.PAGE;this._maxComponentTimeoutInterval=null;for(var e=0;e<b.length;e++){var f=d.findComponent(b[e]);if(f){f=f.getTimeout();if(-1==f){this._maxComponentTimeoutInterval=f;break}null==this._maxComponentTimeoutInterval?this._maxComponentTimeoutInterval=f:f>this._maxComponentTimeoutInterval&&(this._maxComponentTimeoutInterval=f)}}null!=this._maxComponentTimeoutInterval&&(a=this._maxComponentTimeoutInterval);
return a};AdfUserInactivityTimeoutHelper.prototype._forceComponentStop=function(){this._hasTimedOut=!0;this._forcePollingComponentStop();this._forceADSStop();var a=AdfPage.PAGE;null!=this._timeoutTimer&&(a.cancelTimer(this._timeoutTimer),this._timeoutTimer=null)};AdfUserInactivityTimeoutHelper.prototype._forcePollingComponentStop=function(){var a=AdfPage.PAGE;null!=a.getComponentIdsUpdatedByPollEvent()&&a.scheduleTimer(this,this._applyPollTimeoutStyle,null,500)};
AdfUserInactivityTimeoutHelper.prototype._forceADSStop=function(){var a=AdfPage.PAGE;a.isActiveDataSupported()&&(a.getActiveDataSupport().stop(),a=a.__getSessionTimeoutHelper())&&(a.__cancelSessionTimeoutTimer(),a.__startSessionTimeoutTimer())};
AdfUserInactivityTimeoutHelper.prototype._applyPollTimeoutStyle=function(){for(var a=AdfPage.PAGE.getComponentIdsUpdatedByPollEvent(),b=[],d=AdfAgent.AGENT,e=0;e<a.length;e++){var f=d.getElementById(a[e]);if(f){AdfDomUtils.addCSSClassName(f,"p_AFNoUpdate");var g=this._createPollingTimeoutLayerElement(f);b.push(g);f.parentNode.insertBefore(g,f)}}this._timeoutLayers=b};
AdfUserInactivityTimeoutHelper.prototype._createPollingTimeoutLayerElement=function(a){AdfAssert.assertDomElement(a);var b=AdfAgent.AGENT,d=AdfPage.PAGE.getDomDocument().createElement("div");d.className="p_AFNoUpdateBadge";var e=d.style,f=AdfDomUtils.getRelativePosition(a);e.top=f.y+"px";e.left=f.x+"px";e.width=a.offsetWidth+"px";e.height=a.offsetHeight+"px";e.position="absolute";e.visibility="visible";a=b.getComputedStyle(a);e.zIndex="auto"==a.zIndex?1:a.zIndex+1;return d};
AdfUserInactivityTimeoutHelper.prototype._removePollingTimeoutLayer=function(){var a=AdfPage.PAGE.getComponentIdsUpdatedByPollEvent(),b=this._timeoutLayers;if(b&&b.length){for(var d=0;d<b.length;d++){var e=b.pop();e.parentNode.removeChild(e)}b=AdfAgent.AGENT;for(d=0;d<a.length;d++)(e=b.getElementById(a.pop()))&&AdfDomUtils.removeCSSClassName(e,"p_AFNoUpdate")}};
AdfUserInactivityTimeoutHelper.prototype.__resetTimeoutHandler=function(a){-1!=this._globalTimeoutInterval&&"mouseover"!=a.type&&"mouseout"!=a.type&&"blur"!=a.type&&"focus"!=a.type&&(a=AdfPage.PAGE.__getSessionTimeoutHelper(),a&&a.getTimeoutWindowState()==AdfSessionTimeoutHelper.TimeoutWindowStates.LAUNCHED||(this._removePollingTimeoutLayer(),this._rescheduleOrScheduleTimerIfNeeded()))};
AdfUserInactivityTimeoutHelper.prototype._rescheduleOrScheduleTimerIfNeeded=function(){var a=AdfPage.PAGE;if(a.isActiveDataSupported()){var b=a.__getSessionTimeoutHelper();b&&b.__cancelSessionTimeoutTimer()}null!=this._timeoutTimer&&a.cancelTimer(this._timeoutTimer);this._timeoutTimer=null;this._globalTimeoutInterval&&-1!=this._globalTimeoutInterval&&(this._timeoutTimer=a.scheduleTimer(this,this._forceComponentStop,null,this._globalTimeoutInterval));this._hasTimedOut=!1};